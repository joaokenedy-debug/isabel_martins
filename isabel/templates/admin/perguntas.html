{% extends "base_admin.html" %}
{% block title %}Gerenciar Perguntas{% endblock %}

{% block content %}

<h2 class="page-title"><i class="fa-solid fa-list-check"></i> Gerenciar Perguntas</h2>

<!-- CARD: ADICIONAR PERGUNTA -->
<div class="card">
    <h3 class="card-title"><i class="fa-solid fa-plus"></i> Adicionar Pergunta</h3>

    <form action="{{ url_for('admin_pergunta_add') }}" method="post" class="form-grid">
        <div class="form-group">
            <label>Grupo</label>
            <input name="grupo" placeholder="Ex: Atendimento" required>
        </div>

        <div class="form-group">
            <label>Pergunta</label>
            <input name="texto" placeholder="Digite a pergunta" required>
        </div>

        <button class="btn primary"><i class="fa-solid fa-check"></i> Salvar</button>
    </form>
</div>


<!-- CARD: LISTA DE PERGUNTAS -->
<div class="card">
    <h3 class="card-title"><i class="fa-solid fa-database"></i> Todas as Perguntas</h3>

    <table class="admin-table">
        <thead>
            <tr>
                <th>ID</th>
                <th>Grupo</th>
                <th>Pergunta</th>
                <th style="width: 230px">Ações</th>
            </tr>
        </thead>

        <tbody>
            {% for p in perguntas %}
            <tr>
                <td>{{ p['id'] }}</td>
                <td>{{ p['grupo'] }}</td>

                <td>
                    <form action="{{ url_for('admin_pergunta_edit', id=p['id']) }}" method="post" class="edit-form">
                        <input name="texto" value="{{ p['texto'] }}" class="edit-input">
                        <button class="btn small"><i class="fa-solid fa-save"></i></button>
                    </form>
                </td>

                <td>
                    <div class="action-buttons">

                        <!-- EXCLUIR PERGUNTA -->
                        <form action="{{ url_for('admin_pergunta_delete', id=p['id']) }}"
                              method="post"
                              onsubmit="return confirm('Tem certeza que deseja excluir esta pergunta?')">
                            <button class="btn small danger">
                                <i class="fa-solid fa-trash"></i> Excluir
                            </button>
                        </form>

                        <!-- EXCLUIR GRUPO INTEIRO -->
                        <form action="{{ url_for('admin_excluir_grupo', grupo=p['grupo']) }}"
                              method="post"
                              onsubmit="return confirm('Excluir TODO o grupo {{ p['grupo'] }}?')">

                            <button class="btn small warning">
                                <i class="fa-solid fa-folder-minus"></i> Excluir Grupo
                            </button>
                        </form>

                    </div>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

{% endblock %}

